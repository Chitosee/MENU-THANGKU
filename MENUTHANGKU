--// Services
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

--// Screen GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MenuGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

--// Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 250, 0, 300)
mainFrame.Position = UDim2.new(0.05, 0, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
mainFrame.BackgroundTransparency = 0.2
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = screenGui

--// UI Corner
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 10)
UICorner.Parent = mainFrame

--// Layout
local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 5)
UIListLayout.FillDirection = Enum.FillDirection.Vertical
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIListLayout.VerticalAlignment = Enum.VerticalAlignment.Top
UIListLayout.Parent = mainFrame

--// Button Creator
local function createButton(text)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 220, 0, 40)
    btn.BackgroundColor3 = Color3.fromRGB(70, 150, 200)
    btn.Text = text
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 18
    btn.Parent = mainFrame
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = btn
    return btn
end

-------------------------------------------------
-- 1. Auto Fish (Complete Minigame)
local autoFish = false
local autoFishLoop
local menuButton1 = createButton("AUTO FISH: OFF")

menuButton1.MouseButton1Click:Connect(function()
    autoFish = not autoFish
    if autoFish then
        menuButton1.Text = "AUTO FISH: ON"
        menuButton1.BackgroundColor3 = Color3.fromRGB(70, 200, 150)

        autoFishLoop = task.spawn(function()
            while autoFish do
                task.wait()
                local rod = player.Character:FindFirstChild("NormalRod")
                if rod and rod:FindFirstChild("MiniGame") then
                    local args = {"Complete"}
                    rod.MiniGame:FireServer(unpack(args))
                end
            end
        end)

    else
        menuButton1.Text = "AUTO FISH: OFF"
        menuButton1.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
        autoFish = false
    end
end)

-------------------------------------------------
-- 2. Auto Buy Anti Fall
local autoBuyAntiFall = false
local menuButton2 = createButton("AUTO BUY ANTI FALL: OFF")

menuButton2.MouseButton1Click:Connect(function()
    autoBuyAntiFall = not autoBuyAntiFall
    if autoBuyAntiFall then
        menuButton2.Text = "AUTO BUY ANTI FALL: ON"
        menuButton2.BackgroundColor3 = Color3.fromRGB(70, 200, 150)

        -- auto beli pas respawn
        player.CharacterAdded:Connect(function()
            if autoBuyAntiFall then
                task.wait(1)
                local args = {"Anti Fall Damage"}
                ReplicatedStorage:WaitForChild("RequestItemPurchase"):FireServer(unpack(args))
            end
        end)

        -- beli langsung sekali
        local args = {"Anti Fall Damage"}
        ReplicatedStorage:WaitForChild("RequestItemPurchase"):FireServer(unpack(args))

    else
        menuButton2.Text = "AUTO BUY ANTI FALL: OFF"
        menuButton2.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
        autoBuyAntiFall = false
    end
end)

-------------------------------------------------
-- 3. Auto Buy + Use Makan Minum
local autoBuyFoodDrink = false
local autoBuyFoodDrinkLoop
local menuButton3 = createButton("AUTO BUY MAKAN MINUM: OFF")

menuButton3.MouseButton1Click:Connect(function()
    autoBuyFoodDrink = not autoBuyFoodDrink
    if autoBuyFoodDrink then
        menuButton3.Text = "AUTO BUY MAKAN MINUM: ON"
        menuButton3.BackgroundColor3 = Color3.fromRGB(200, 150, 70)

        local function buyAndUseFoodDrink()
            -- beli Burger
            local args1 = {"Burger"}
            ReplicatedStorage:WaitForChild("RequestItemPurchase"):FireServer(unpack(args1))
            task.wait(0.5)
            local burger = player.Backpack:FindFirstChild("Burger")
            if burger then
                burger.Parent = player.Character
                task.wait(0.2)
                burger:Activate()
            end

            -- beli Water
            local args2 = {"water"}
            ReplicatedStorage:WaitForChild("RequestItemPurchase"):FireServer(unpack(args2))
            task.wait(0.5)
            local water = player.Backpack:FindFirstChild("water")
            if water then
                water.Parent = player.Character
                task.wait(0.2)
                water:Activate()
            end
        end

        -- loop tiap 5 menit
        autoBuyFoodDrinkLoop = task.spawn(function()
            while autoBuyFoodDrink do
                buyAndUseFoodDrink()
                for i = 1, 300 do
                    if not autoBuyFoodDrink then break end
                    task.wait(1)
                end
            end
        end)

        buyAndUseFoodDrink()
    else
        menuButton3.Text = "AUTO BUY MAKAN MINUM: OFF"
        menuButton3.BackgroundColor3 = Color3.fromRGB(70, 150, 200)
        autoBuyFoodDrink = false
    end
end)

-------------------------------------------------
-- 4. Anti AFK
local antiAFK = false
local menuButton4 = createButton("ANTI AFK: OFF")

menuButton4.MouseButton1Click:Connect(function()
    antiAFK = not antiAFK
    if antiAFK then
        menuButton4.Text = "ANTI AFK: ON"
        menuButton4.BackgroundColor3 = Color3.fromRGB(150, 200, 70)

        player.Idled:Connect(function()
            if antiAFK then
                VirtualUser:CaptureController()
                VirtualUser:ClickButton2(Vector2.new())
            end
        end)

    else
        menuButton4.Text = "ANTI AFK: OFF"
        menuButton4.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
        antiAFK = false
    end
end)

-------------------------------------------------
-- 5. Auto Farm Ikan
local autoFarmIkan = false
local autoFarmLoop
local menuButton5 = createButton("AUTO FARM IKAN: OFF")

menuButton5.MouseButton1Click:Connect(function()
    autoFarmIkan = not autoFarmIkan
    if autoFarmIkan then
        menuButton5.Text = "AUTO FARM IKAN: ON"
        menuButton5.BackgroundColor3 = Color3.fromRGB(70, 200, 150)

        autoFarmLoop = task.spawn(function()
            while autoFarmIkan do
                local args = {"Fish"}
                ReplicatedStorage:WaitForChild("RequestItemPurchase"):FireServer(unpack(args))
                task.wait(0.5)
                local ikan = player.Backpack:FindFirstChild("Fish")
                if ikan then
                    ikan.Parent = player.Character
                    task.wait(0.2)
                    ikan:Activate()
                end
                for i = 1, 2 do
                    if not autoFarmIkan then break end
                    task.wait(1)
                end
            end
        end)

    else
        menuButton5.Text = "AUTO FARM IKAN: OFF"
        menuButton5.BackgroundColor3 = Color3.fromRGB(200, 70, 150)
        autoFarmIkan = false
    end
end)
