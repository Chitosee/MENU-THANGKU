--// SERVICES
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local VirtualUser = game:GetService("VirtualUser")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

--// GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MenuGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 250, 0, 330)
frame.Position = UDim2.new(0, 20, 0.5, -165)
frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 40)
title.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
title.Text = "⚡ AUTO FARM MENU ⚡"
title.TextColor3 = Color3.new(1, 1, 1)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.Parent = frame

-- Fungsi buat tombol
local function createButton(name, order)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, -20, 0, 40)
    button.Position = UDim2.new(0, 10, 0, order * 45)
    button.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    button.TextColor3 = Color3.new(1, 1, 1)
    button.Font = Enum.Font.SourceSansBold
    button.TextSize = 16
    button.Text = name
    button.Parent = frame
    return button
end

-- Fungsi beli 1 item saja (cek dulu)
local function buyOnce(itemName)
    if not player.Backpack:FindFirstChild(itemName) and not player.Character:FindFirstChild(itemName) then
        ReplicatedStorage:WaitForChild("RequestItemPurchase"):FireServer(itemName)
    end
end

-------------------------------------------------
-- 1. Auto Fish (Complete Minigame)
local autoFish = false
local menuButton1 = createButton("AUTO FISH: OFF", 1)

menuButton1.MouseButton1Click:Connect(function()
    autoFish = not autoFish
    if autoFish then
        menuButton1.Text = "AUTO FISH: ON"
        menuButton1.BackgroundColor3 = Color3.fromRGB(70, 200, 150)
        task.spawn(function()
            while autoFish do
                task.wait()
                local rod = player.Character:FindFirstChild("NormalRod")
                if rod and rod:FindFirstChild("MiniGame") then
                    rod.MiniGame:FireServer("Complete")
                end
            end
        end)
    else
        menuButton1.Text = "AUTO FISH: OFF"
        menuButton1.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
    end
end)

-------------------------------------------------
-- 2. Auto Buy Anti Fall
local autoAntiFall = false
local menuButton2 = createButton("AUTO BUY ANTI FALL: OFF", 2)

menuButton2.MouseButton1Click:Connect(function()
    autoAntiFall = not autoAntiFall
    if autoAntiFall then
        menuButton2.Text = "AUTO BUY ANTI FALL: ON"
        menuButton2.BackgroundColor3 = Color3.fromRGB(70, 200, 150)
        
        buyOnce("Anti Fall Damage")
        player.CharacterAdded:Connect(function()
            if autoAntiFall then
                task.wait(1)
                buyOnce("Anti Fall Damage")
            end
        end)
    else
        menuButton2.Text = "AUTO BUY ANTI FALL: OFF"
        menuButton2.BackgroundColor3 = Color3.fromRGB(200, 70, 150)
    end
end)

-------------------------------------------------
-- 3. Auto Buy + Use Makan/Minum (Loop setiap 10 detik)
local autoBuyFoodDrink = false
local menuButton3 = createButton("AUTO BUY MAKAN MINUM: OFF", 3)

menuButton3.MouseButton1Click:Connect(function()
    autoBuyFoodDrink = not autoBuyFoodDrink
    if autoBuyFoodDrink then
        menuButton3.Text = "AUTO BUY MAKAN MINUM: ON"
        menuButton3.BackgroundColor3 = Color3.fromRGB(70, 200, 150)
        
        task.spawn(function()
            while autoBuyFoodDrink do
                -- Beli dan gunakan Burgerr
                buyOnce("Burgerr")
                task.wait(0.5)
                local Burgerr = player.Backpack:FindFirstChild("Burgerr")
                if Burgerr then
                    Burgerr.Parent = player.Character
                    task.wait(0.5)
                    if Burgerr:IsA("Tool") then
                        Burgerr:Activate()
                    end
                end

                -- Beli dan gunakan Air Minum
                buyOnce("Air Minum")
                task.wait(0.5)
                local Air Minum = player.Backpack:FindFirstChild("Air Minum")
                if Air Minum then
                    Air Minum.Parent = player.Character
                    task.wait(0.5)
                    if Air Minum:IsA("Tool") then
                        Air Minum:Activate()
                    end
                end

                -- Jeda 10 detik sebelum loop berikutnya
                task.wait(10)
            end
        end)
    else
        menuButton3.Text = "AUTO BUY MAKAN MINUM: OFF"
        menuButton3.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
    end
end)

-------------------------------------------------
-- 4. Anti AFK
local antiAfk = false
local menuButton4 = createButton("ANTI AFK: OFF", 4)

menuButton4.MouseButton1Click:Connect(function()
    antiAfk = not antiAfk
    if antiAfk then
        menuButton4.Text = "ANTI AFK: ON"
        menuButton4.BackgroundColor3 = Color3.fromRGB(150, 200, 70)
        player.Idled:Connect(function()
            if antiAfk then
                VirtualUser:Button2Down(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
                task.wait(1)
                VirtualUser:Button2Up(Vector2.new(0,0),workspace.CurrentCamera.CFrame)
            end
        end)
    else
        menuButton4.Text = "ANTI AFK: OFF"
        menuButton4.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
    end
end)

-------------------------------------------------
-- 5. Ambil Pancingan
local menuButton5 = createButton("AMBIL PANCINGAN", 5)
local rodName = "NormalRod"

menuButton5.MouseButton1Click:Connect(function()
    local args = {
        rodName,
        1
    }
    game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("BankWithdraw"):FireServer(unpack(args))
end)

-------------------------------------------------
-- 6. Simpan Pancingan
local menuButton6 = createButton("SIMPAN PANCINGAN", 6)

menuButton6.MouseButton1Click:Connect(function()
    local args = {
        "NormalRod",
        1
    }
    game:GetService("ReplicatedStorage"):WaitForChild("RemoteFunctions"):WaitForChild("TryDepositItem"):InvokeServer(unpack(args))
    task.wait(0.5)
    local args = {
        "NormalRod",
        1
    }
    game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("BankDeposit"):FireServer(unpack(args))
end)
